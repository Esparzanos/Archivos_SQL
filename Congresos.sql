CREATE DATABASE CONGRESO
GO
USE CONGRESO
GO

--CREAR TABLAS--
CREATE TABLE CONGRESOS (
	CONID INT NOT NULL,
	CONNOMBRE VARCHAR(50) NOT NULL,
	CONDESCRIPCION VARCHAR(50),
	CONFECHAINI DATE NOT NULL,
	CONFECHAFIN DATE NOT NULL,
	CONLUGAR VARCHAR(50) NOT NULL
	)
GO
CREATE TABLE EXPOSITORES (
	EXPID INT NOT NULL, 
	EXPNOMBRE VARCHAR(50)NOT NULL,
	EXPAPELLIDOS VARCHAR(50)NOT NULL,
	EXPCORREO VARCHAR(256),
	EXPCELULAR VARCHAR(10)
)
GO
CREATE TABLE EVENTOS (
	EVEID INT NOT NULL,
	EVENOMBRE VARCHAR(50) NOT NULL,
	EVEDESCRIPCION VARCHAR(50),
	EVEFECHA DATE NOT NULL,
	EVELUGAR VARCHAR(50)NOT NULL,
	EVECOSTO DECIMAL (10, 2) NOT NULL,
	EXPID INT NOT NULL
)
GO
CREATE TABLE EVENTOXREG(
	FOLIO INT NOT NULL,
	EVEID INT NOT NULL
)
GO
CREATE TABLE MUNICIPIOS(
	MUNID INT NOT NULL,
	MUNNOMBRE VARCHAR(45) NOT NULL
)
GO
CREATE TABLE ESCUELAS(
	ESCID INT NOT NULL,
	ESCNOMBRE VARCHAR(45)NOT NULL,
	ESCDOMICILIO VARCHAR(50)NOT NULL,
	MUNID INT NOT NULL
)
GO
CREATE TABLE ESTUDIANTES(
	ESTID INT NOT NULL,
	ESTNOMBRE VARCHAR(50)NOT NULL,
	ESTAPELLIDOS VARCHAR(50)NOT NULL,
	ESTDOMICILIO VARCHAR(50),
	ESTCORREO VARCHAR(256),
	ESTCELULAR VARCHAR(10),
	ESCID INT NOT NULL
)
GO
CREATE TABLE REGISTROS(
	FOLIO INT NOT NULL,
	FECHA DATE NOT NULL,
	ESTID INT NOT NULL,
	CONID INT NOT NULL	
)
GO

--AGREGAR CLAVES PRIMARIAS--
ALTER TABLE CONGRESOS ADD CONSTRAINT PK_CONGRESO PRIMARY KEY(CONID)
GO
ALTER TABLE EXPOSITORES ADD CONSTRAINT PK_EXPOSITORES PRIMARY KEY(EXPID)
GO
ALTER TABLE EVENTOS ADD CONSTRAINT PK_EVENTOS PRIMARY KEY(EVEID)
GO
ALTER TABLE MUNICIPIOS ADD CONSTRAINT PK_MUNICIPIOS PRIMARY KEY(MUNID)
GO
ALTER TABLE ESCUELAS ADD CONSTRAINT PK_ESCUELAS PRIMARY KEY(ESCID)
GO
ALTER TABLE ESTUDIANTES ADD CONSTRAINT PK_ESTUDIANTES PRIMARY KEY(ESTID)
GO
ALTER TABLE REGISTROS ADD CONSTRAINT PK_REGISTROS PRIMARY KEY(FOLIO)
GO

--AGREGAR CLAVES FORANEAS--
ALTER TABLE EVENTOS ADD CONSTRAINT FK_EVENTOS_EXPOSITORES
FOREIGN KEY (EXPID) REFERENCES EXPOSITORES(EXPID)
GO
ALTER TABLE EVENTOXREG ADD CONSTRAINT FK_EVENTOXREG_EVENTOS
FOREIGN KEY (EVEID) REFERENCES EVENTOS(EVEID)
GO
ALTER TABLE EVENTOXREG ADD CONSTRAINT FK_EVENTOXREG_REGISTROS
FOREIGN KEY (FOLIO) REFERENCES REGISTROS(FOLIO)
GO
ALTER TABLE ESCUELAS ADD CONSTRAINT FK_ESCUELAS_MUNICIPIOS
FOREIGN KEY (MUNID) REFERENCES MUNICIPIOS(MUNID)
GO
ALTER TABLE ESTUDIANTES ADD CONSTRAINT FK_ESTUDIANTES_ESCUELAS
FOREIGN KEY (ESCID) REFERENCES ESCUELAS(ESCID)
GO
ALTER TABLE REGISTROS ADD CONSTRAINT FK_REGISTROS_ESTUDIANTES
FOREIGN KEY (ESTID) REFERENCES ESTUDIANTES(ESTID)
GO
ALTER TABLE REGISTROS ADD CONSTRAINT FK_REGISTROS_CONGRESOS
FOREIGN KEY (CONID) REFERENCES CONGRESOS(CONID)
GO

--NO TIENE LLAVES UNICAS--
--VALORES DEFAULT--
ALTER TABLE CONGRESOS ADD CONSTRAINT DEF_CONGRESOS_CONDESCRIPCION DEFAULT('SIN DESCRIPCION') FOR CONDESCRIPCION
GO
ALTER TABLE EXPOSITORES ADD CONSTRAINT DEF_EXPOSITORES_EXPCORREO DEFAULT('CORREO DESCONOCIDO') FOR EXPCORREO
GO
ALTER TABLE EXPOSITORES ADD CONSTRAINT DEF_EXPOSITORES_EXPCELULAR DEFAULT('CELULAR DESCONOCIDO') FOR EXPCELULAR
GO
ALTER TABLE EVENTOS ADD CONSTRAINT DEF_EVENTOS_EVEDESCRIPCION DEFAULT('SIN DESCRIPCION') FOR EVEDESCRIPCION
GO
ALTER TABLE ESTUDIANTES ADD CONSTRAINT DEF_ESTUDIANTES_ESTDOMICILIO DEFAULT('DOMICILIO DESCONOCIDO') FOR ESTDOMICILIO
GO
ALTER TABLE ESTUDIANTES ADD CONSTRAINT DEF_ESTUDIANTES_ESTCORREO DEFAULT('CORREO DESCONOCIDO') FOR ESTCORREO
GO
ALTER TABLE ESTUDIANTES ADD CONSTRAINT DEF_ESTUDIANTES_ESTCELULAR DEFAULT('CELULAR DESCONOCIDO') FOR ESTCELULAR
GO

--COMPROBACIONES--
ALTER TABLE CONGRESOS ADD CHECK (CONFECHAINI > GETDATE())
GO
ALTER TABLE CONGRESOS ADD CHECK (CONFECHAFIN <> CONFECHAINI)
GO
ALTER TABLE EVENTOS ADD CHECK (EVEFECHA > GETDATE())
GO

--AGREGAR DATOS A LAS TABLAS--
INSERT INTO CONGRESOS (CONID, CONNOMBRE, CONDESCRIPCION, CONFECHAINI, CONFECHAFIN, CONLUGAR)
VALUES 
    (6, 'Simposio de Ciencia Ficción', 'Exploración de tecnología futurista', '2023-11-15', '2023-11-17', 'Estación Espacial'),
    (7, 'Festival de Arte Surrealista', 'Exhibición de obras oníricas', '2023-10-25', '2023-10-27', 'Mundo de los Sueños'),
    (8, 'Cumbre de la Imaginación', 'Celebración de la creatividad', '2023-09-30', '2023-10-02', 'Ciudad de la Imaginación'),
    (9, 'Conferencia de Viajes en el Tiempo', 'Descubriendo las paradojas temporales', '2023-12-05', '2023-12-07', 'Sala de Máquinas del Tiempo'),
    (10, 'Congreso de Extraterrestres', 'Encuentro intergaláctico', '2023-11-10', '2023-11-12', 'Planeta XZ-47')
GO

INSERT INTO EXPOSITORES (EXPID, EXPNOMBRE, EXPAPELLIDOS, EXPCORREO, EXPCELULAR)
VALUES 
    (6, 'E.T.', 'el Extraterrestre', 'et@example.com', '9876543210'),
    (7, 'Leonardo', 'Da Vinci', 'leonardo@example.com', '1234567890'),
    (8, 'Alice', 'en el País de las Maravillas', 'alice@example.com', '8765432109'),
    (9, 'Dr. Brown', 'Emmett', 'doc@example.com', '5551212121'),
    (10, 'Cthulhu', 'el Primigenio', 'cthulhu@example.com', '6666666666')
GO

INSERT INTO EVENTOS (EVEID, EVENOMBRE, EVEDESCRIPCION, EVEFECHA, EVELUGAR, EVECOSTO, EXPID)
VALUES 
    (6, 'Exhibición de Tecnología Alienígena', 'Muestra de gadgets de otras galaxias', '2023-11-16', 'Área 51', 20.99, 6),
    (7, 'Taller de Pintura de Sueños', 'Creando obras en el subconsciente', '2023-10-26', 'Inframundo', 15.75, 7),
    (8, 'Hackathon de Ideas Locas', 'Desarrollo de proyectos insólitos', '2023-10-01', 'Nube de Burbujas', 5.50, 8),
    (9, 'Seminario de Viajes Temporales', 'Explorando el pasado y futuro', '2023-12-06', 'Dimensiones Paralelas', 30.25, 9),
    (10, 'Panel de Discusión Alienígena', 'Debatiendo sobre la vida extraterrestre', '2023-11-11', 'Universo Desconocido', 10.00, 10)
GO

INSERT INTO MUNICIPIOS (MUNID, MUNNOMBRE)
VALUES 
    (6, 'Mundo de Ensueño'),
    (7, 'Ciudad de la Imaginación'),
    (8, 'Reino de las Maravillas'),
    (9, 'Sala de Máquinas del Tiempo'),
    (10, 'Planeta XZ-47')
GO

INSERT INTO ESCUELAS (ESCID, ESCNOMBRE, ESCDOMICILIO, MUNID)
VALUES 
    (6, 'Escuela de Ciencia Ficción', 'Avenida Futurista', 6),
    (7, 'Academia Surrealista', 'Calle de los Sueños', 7),
    (8, 'Instituto de Imaginación', 'Bulevar Creativo', 8),
    (9, 'Instituto de Ciencias Temporales', 'Calle de los Crononautas', 9),
    (10, 'Escuela de Astrobiología', 'Carretera Intergaláctica', 10)
GO

INSERT INTO ESTUDIANTES (ESTID, ESTNOMBRE, ESTAPELLIDOS, ESTDOMICILIO, ESTCORREO, ESTCELULAR, ESCID)
VALUES 
    (6, 'Neo', 'Matrix', 'Matrix City', 'neo@example.com', '7777777777', 6),
    (7, 'Alicia', 'en el País de las Maravillas', 'País de las Maravillas', 'alicia@example.com', '8888888888', 7),
    (8, 'Marty', 'McFly', 'Hill Valley', 'marty@example.com', '9999999999', 8),
    (9, 'Doctor', 'Quién', 'Gallifrey', 'doctor@example.com', '1111111111', 9),
    (10, 'E.T.', 'el Extraterrestre', 'Bosque Encantado', 'et@example.com', '2222222222', 10)
GO

INSERT INTO REGISTROS (FOLIO, FECHA, ESTID, CONID)
VALUES 
    (6, '2023-09-20', 6, 6),
    (7, '2023-09-21', 7, 7),
    (8, '2023-09-22', 8, 8),
    (9, '2023-09-23', 9, 9),
    (10, '2023-09-24', 10, 10)
GO

INSERT INTO EVENTOXREG (FOLIO, EVEID)
VALUES 
    (6, 6),
    (7, 7),
    (8, 8),
    (9, 9),
    (10, 10);
